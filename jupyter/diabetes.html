<html>

<head>
    <title>Diabetes</title>
    <style>
        svg {
            border: 1px solid black;
        }

        svg g rect.node-shape {
            border-radius: 5px !important;
            fill: #ffecb3 !important;
            cursor: move;
        }

        svg g text.node-name {
            font-weight: 800 !important
        }

        svg g rect.node-bar {
            fill: green !important
        }

        svg g text.node-value {
            fill: rgb(0, 0, 0) !important;
            font-size: 15px;
            cursor: pointer;
        }

        svg line.edge-line {
            stroke: rgb(0, 0, 0) !important
        }

        svg path.edge-head {
            fill: rgb(0, 0, 0) !important
        }
    </style>
</head>

<body>
    <svg id="bbn">
    </svg>

    <script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.js"></script>
    <script src="https://cdn.jsdelivr.net/lodash/4.11.1/lodash.js"></script>
    <script src="https://rawgithub.com/cpettitt/graphlib/master/dist/graphlib.core.js"></script>
    <script src="https://rawgithub.com/cpettitt/dagre/master/dist/dagre.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
    <script src="https://rawgithub.com/vangj/jsbayes/master/jsbayes.js"></script>
    <script src="https://rawgithub.com/vangj/jsbayes-viz/master/jsbayes-viz.js"></script>
    <script>
        const data = {"dm": {"cpt": [[0.8682813760067857, 0.13171862399321435], [0.7840104742082059, 0.21598952579179406], [0.8078182123059288, 0.1921817876940712], [0.698305119037417, 0.30169488096258296], [0.7915393308372818, 0.2084606691627182], [0.6764650923594449, 0.32353490764055515], [0.707707669656831, 0.292292330343169], [0.5714136951869733, 0.42858630481302673], [0.7714630376935141, 0.2285369623064859], [0.6502038678779559, 0.3497961321220441], [0.6827932421779574, 0.31720675782204255], [0.5423937083961986, 0.4576062916038014], [0.660376431261425, 0.339623568738575], [0.5170725648726961, 0.4829274351273039], [0.553548763200901, 0.44645123679909904], [0.40573245017553505, 0.594267549824465], [0.7671866111050093, 0.2328133888949907], [0.6447034139848604, 0.35529658601513964], [0.6775511090357473, 0.3224488909642527], [0.5364067017838166, 0.4635932982161834], [0.6549510505385385, 0.3450489494614615], [0.5110529140108926, 0.4889470859891074], [0.5475859679517182, 0.4524140320482818], [0.399935553157414, 0.600064446842586], [0.6279041000352803, 0.37209589996471965], [0.4816533605060115, 0.5183466394939885], [0.518312637051203, 0.48168736294879705], [0.3720640803593105, 0.6279359196406895], [0.49290477566935254, 0.5070952243306475], [0.3486364708859543, 0.6513635291140457], [0.38264529541796455, 0.6173547045820355], [0.25445515816275577, 0.7455448418372442], [0.8213638211047357, 0.17863617889526429], [0.7168641604252541, 0.28313583957474586], [0.7456722620017477, 0.25432773799825226], [0.6175133843904566, 0.3824866156095434], [0.7259153289304126, 0.2740846710695874], [0.5932316132473368, 0.4067683867526633], [0.6280928548936247, 0.3719071451063753], [0.48185508383833875, 0.5181449161616613], [0.7018991590419763, 0.29810084095802364], [0.5645631760715013, 0.4354368239284987], [0.6002256536884802, 0.3997743463115198], [0.4525804602898694, 0.5474195397101306], [0.5756006649035393, 0.42439933509646066], [0.4275348483321446, 0.5724651516678554], [0.46376035600552146, 0.5362396439944785], [0.3225956752336453, 0.6774043247663547], [0.6968325755732925, 0.3031674244267075], [0.5586301929331973, 0.44136980706680273], [0.5944295140214885, 0.40557048597851153], [0.44661726058090756, 0.5533827394190924], [0.5697034480441954, 0.4302965519558046], [0.42164746780999707, 0.5783525321900029], [0.4577730331262978, 0.5422269668737022], [0.3173522734849735, 0.6826477265150265], [0.540660748293182, 0.45933925170681805], [0.3932545103570668, 0.6067454896429332], [0.42875083081098175, 0.5712491691890182], [0.2924313117452778, 0.7075686882547222], [0.4040505915021211, 0.5959494084978789], [0.27184714836418167, 0.7281528516358183], [0.3018364263724135, 0.6981635736275865], [0.19228610117739997, 0.8077138988226]], "parents": ["infec_parasitic", "mental", "nervous_sys", "dige_sys", "skin", "muscle_sys"]}, "infec_parasitic": {"cpt": [[0.9712375186550404, 0.028762481344959623], [0.9665010599702861, 0.03349894002971393], [0.9656057574987761, 0.03439424250122388], [0.9599801030883972, 0.040019896911602765], [0.9654548881279952, 0.03454511187200481], [0.9598055841420595, 0.04019441585794047], [0.9587389757998552, 0.04126102420014482], [0.9520459425999391, 0.04795405740006091]], "parents": ["mental", "dige_sys", "muscle_sys"]}, "neoplasms": {"cpt": [[0.8415286631435978, 0.15847133685640227], [0.6259818309611054, 0.3740181690388946], [0.7635144354643961, 0.23648556453560393], [0.5043537637853128, 0.4956462362146872]], "parents": ["obesity", "dige_sys"]}, "obesity": {"cpt": [[0.6407770550309047, 0.3592229449690954], [0.6000869783945414, 0.3999130216054586]], "parents": ["circ_sys"]}, "blood": {"cpt": [[0.9934968790240328, 0.006503120975967224], [0.991623122456163, 0.008376877543836932], [0.9907099957104842, 0.00929000428951577], [0.9880429134418199, 0.011957086558180095], [0.9922392806830287, 0.007760719316971304], [0.9900068146974765, 0.009993185302523468], [0.9889194700525814, 0.011080529947418616], [0.9857457389331441, 0.014254261066855869]], "parents": ["neoplasms", "nervous_sys", "dige_sys"]}, "mental": {"cpt": [[0.8748560318755888, 0.12514396812441117], [0.8210198008551358, 0.17898019914486418]], "parents": ["obesity"]}, "nervous_sys": {"cpt": [[0.7990223037148532, 0.20097769628514678], [0.6821116632446637, 0.31788833675533634]], "parents": ["muscle_sys"]}, "circ_sys": {"cpt": [0.8876324156931389, 0.11236758430686111], "parents": []}, "resp_sys": {"cpt": [[0.750257485301276, 0.24974251469872402], [0.6725323932985681, 0.327467606701432], [0.669985607987508, 0.3300143920124921], [0.581222791727753, 0.418777208272247]], "parents": ["mental", "muscle_sys"]}, "dige_sys": {"cpt": [[0.7210418958109636, 0.27895810418903644], [0.6246391096829104, 0.37536089031708963], [0.6238100954338235, 0.37618990456617646], [0.5163447718496104, 0.4836552281503897]], "parents": ["mental", "muscle_sys"]}, "gen_uri_sys": {"cpt": [[0.8079205899772519, 0.19207941002274811], [0.7485844088390181, 0.25141559116098194], [0.7778706841740508, 0.22212931582594925], [0.7125543398837566, 0.28744566011624334], [0.7791983031751243, 0.22080169682487574], [0.7141288734777607, 0.2858711265222393], [0.7460672471717179, 0.2539327528282821], [0.6753027772712047, 0.3246972227287953]], "parents": ["infec_parasitic", "resp_sys", "dige_sys"]}, "pregnancy": {"cpt": [[0.8582851319075331, 0.1417148680924669], [0.8714004192219398, 0.1285995807780602], [0.9343330233484761, 0.06566697665152386], [0.9408949715328802, 0.059105028467119854], [0.7291560927312768, 0.2708439072687232], [0.7507514236029056, 0.24924857639709438], [0.863475640809282, 0.13652435919071806], [0.8761798618518065, 0.12382013814819352], [0.8196063691293317, 0.1803936308706683], [0.8356156713713402, 0.16438432862865981], [0.914338734034334, 0.08566126596566602], [0.9227334377916079, 0.07726656220839208], [0.6688323634463584, 0.33116763655364156], [0.693213824750792, 0.306786175249208], [0.8259262208215343, 0.17407377917846573], [0.8414831330317414, 0.1585168669682586]], "parents": ["infec_parasitic", "obesity", "gen_uri_sys", "muscle_sys"]}, "skin": {"cpt": [[0.8000823956833754, 0.1999176043166247], [0.7146996653033675, 0.2853003346966326], [0.7460586981454673, 0.25394130185453273], [0.6477609584395314, 0.3522390415604686], [0.7727919404099194, 0.22720805959008059], [0.6804094827859271, 0.31959051721407294], [0.7140294584696367, 0.2859705415303632], [0.6098176958552822, 0.3901823041447178]], "parents": ["obesity", "nervous_sys", "muscle_sys"]}, "muscle_sys": {"cpt": [[0.8223401416580184, 0.17765985834198159], [0.7482066493344588, 0.2517933506655412], [0.767829672650853, 0.232170327349147], [0.6798067524416269, 0.32019324755837314]], "parents": ["obesity", "mental"]}, "congenital": {"cpt": [[0.8978645686253819, 0.10213543137461815], [0.904735176876687, 0.09526482312331296], [0.874432389761554, 0.125567610238446], [0.8826732945940847, 0.11732670540591526]], "parents": ["mental", "muscle_sys"]}, "ill_defcond": {"cpt": [[0.5727199766963023, 0.42728002330369774], [0.4594868405395719, 0.5405131594604281], [0.49339610925397237, 0.5066038907460276], [0.38183116301702524, 0.6181688369829748]], "parents": ["infec_parasitic", "muscle_sys"]}, "inj_poi": {"cpt": [[0.8938807635477826, 0.10611923645221742], [0.7911043811550004, 0.2088956188449996]], "parents": ["dige_sys"]}, "ecodes": {"cpt": [[0.952731844591331, 0.047268155408669035], [0.5587717810690419, 0.4412282189309581]], "parents": ["inj_poi"]}, "vcodes": {"cpt": [[0.7800269865217428, 0.21997301347825718], [0.5912221208610503, 0.4087778791389497], [0.7001052818958071, 0.2998947181041928], [0.4877513182996479, 0.5122486817003521], [0.6267613224632999, 0.37323867753670015], [0.406499324925059, 0.593500675074941], [0.5250598125286162, 0.4749401874713838], [0.3107788824300547, 0.6892211175699453]], "parents": ["obesity", "mental", "dige_sys"]}};

        $(document).ready(function () {
            (function (window) {
                var graph = getGraph();
                jsbayesviz.draw({
                    id: '#bbn',
                    width: 2000,
                    height: 1000,
                    graph: graph,
                    samples: 15000
                });

                $('#btnDownloadJson').click(function () {
                    jsbayesviz.downloadSamples(graph, true);
                });

                $('#btnDownloadCsv').click(function () {
                    jsbayesviz.downloadSamples(graph, false, { rowDelimiter: '\n', fieldDelimiter: ',' });
                });
            })(window);
        });

        function getGraph() {
            const g = jsbayes.newGraph();
            g.saveSamples = false;

            const nodes = {};

            for (const [key, d] of Object.entries(data)) {
                const n = g.addNode(key, ['0', '1']);
                n.setCpt(d.cpt);
                nodes[key] = n;
            }

            for (const [key, d] of Object.entries(data)) {
                const parents = d.parents;
                const child = nodes[key];

                parents.forEach(parentId => {
                    const n = nodes[parentId];
                    child.addParent(n);
                });
            }

            g.reinit();
            g.sample(20000);

            return jsbayesviz.fromGraph(g);
        }
    </script>
</body>

</html>